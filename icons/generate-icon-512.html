<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Apple-style Icon Generator 512x512</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #f5f5f7;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        canvas {
            border-radius: 114px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            max-width: 300px;
            max-height: 300px;
        }
        #download {
            padding: 12px 24px;
            background: #007AFF;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
        }
        #download:hover { background: #0051D5; }
        #svgDisplay {
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 200px;
            height: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Maru-Text-to-Speech App Icon</h1>
        <p>512x512 - Apple-style design with history feature indication</p>

        <div id="svgDisplay"></div>
        <canvas id="canvas" width="512" height="512"></canvas>
        <a id="download" download="icon-512.png">Download icon-512.png</a>
    </div>

    <script>
        async function loadSVGAndGenerateIcon() {
            try {
                // Load the SVG file
                const response = await fetch('./icon-512.svg');
                const svgText = await response.text();

                // Display SVG
                document.getElementById('svgDisplay').innerHTML = svgText;

                // Create image from SVG
                const img = new Image();
                const svgBlob = new Blob([svgText], { type: 'image/svg+xml;charset=utf-8' });
                const url = URL.createObjectURL(svgBlob);

                img.onload = function() {
                    const canvas = document.getElementById('canvas');
                    const ctx = canvas.getContext('2d');

                    // Clear canvas
                    ctx.clearRect(0, 0, 512, 512);

                    // Draw SVG to canvas
                    ctx.drawImage(img, 0, 0, 512, 512);

                    // Setup download
                    canvas.toBlob(function(blob) {
                        const downloadUrl = URL.createObjectURL(blob);
                        document.getElementById('download').href = downloadUrl;
                    }, 'image/png');

                    // Clean up
                    URL.revokeObjectURL(url);
                };

                img.src = url;

            } catch (error) {
                console.error('Error loading SVG:', error);

                // Fallback to manual drawing if SVG loading fails
                drawFallbackIcon();
            }
        }

        function drawFallbackIcon() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const size = 512;

            // Background gradient
            const bgGradient = ctx.createLinearGradient(0, 0, size, size);
            bgGradient.addColorStop(0, '#4f46e5');
            bgGradient.addColorStop(0.35, '#3b82f6');
            bgGradient.addColorStop(1, '#06b6d4');

            // Draw rounded rectangle background
            const cornerRadius = 114;
            ctx.fillStyle = bgGradient;
            ctx.beginPath();
            ctx.roundRect(0, 0, size, size, cornerRadius);
            ctx.fill();

            // Inner glow
            const innerGradient = ctx.createLinearGradient(size*0.2, size*0.2, size*0.8, size*0.8);
            innerGradient.addColorStop(0, 'rgba(255,255,255,0.25)');
            innerGradient.addColorStop(1, 'rgba(255,255,255,0.05)');

            ctx.fillStyle = innerGradient;
            ctx.beginPath();
            ctx.roundRect(0, 0, size, size, cornerRadius);
            ctx.fill();

            // Microphone
            const centerX = 256;
            const centerY = 256;

            // Microphone gradient
            const micGradient = ctx.createLinearGradient(centerX-32, centerY-45, centerX+32, centerY+45);
            micGradient.addColorStop(0, '#ffffff');
            micGradient.addColorStop(1, '#f1f5f9');

            // Microphone capsule
            ctx.fillStyle = micGradient;
            ctx.strokeStyle = 'rgba(255,255,255,0.8)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.ellipse(centerX, centerY-45, 32, 45, 0, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();

            // Microphone handle
            ctx.fillRect(centerX-4, centerY, 8, 48);

            // Microphone base
            ctx.beginPath();
            ctx.ellipse(centerX, centerY+48, 24, 8, 0, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();

            // History book (upper right)
            const bookX = 380;
            const bookY = 140;

            // Book gradient
            const bookGradient = ctx.createLinearGradient(bookX, bookY, bookX+64, bookY+80);
            bookGradient.addColorStop(0, '#fbbf24');
            bookGradient.addColorStop(1, '#f59e0b');

            ctx.fillStyle = bookGradient;
            ctx.strokeStyle = 'rgba(255,255,255,0.9)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.roundRect(bookX, bookY, 64, 80, 8);
            ctx.fill();
            ctx.stroke();

            // Book pages
            ctx.fillStyle = 'rgba(255,255,255,0.95)';
            ctx.beginPath();
            ctx.roundRect(bookX+6, bookY+6, 52, 68, 4);
            ctx.fill();

            // Setup download
            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                document.getElementById('download').href = url;
            }, 'image/png');
        }

        // Load SVG when page loads
        loadSVGAndGenerateIcon();
    </script>
</body>
</html>